<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title th:text="${post.title} + ' - DevNote'">文章详情</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">

  <a href="/" class="btn btn-secondary mb-3">← 返回首页</a>

  <h1 th:text="${post.title}">文章标题</h1>
  <p class="text-muted">
    作者：<span th:text="${post.author != null ? post.author.username : '匿名'}">匿名</span>
    |
    发布于：
    <span th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}">时间</span>
  </p>

  <hr>

  <div class="mt-4">
    <p th:utext="${#strings.escapeXml(post.content).replaceAll('\n', '<br/>')}">
      文章内容
    </p>
  </div>

<!--  仅作者可见的 编辑/删除区域-->
  <div th:if="${#authentication.principal?.username == post.author.username}">
    <a th:href="@{'/posts/' + ${post.id} + '/edit'}" class="btn btn-primary">编辑</a>

    <form th:action="@{'/posts/' + ${post.id} + '/delete'}"
          method="post"
          style="display:inline;"
          onsubmit="return confirm('确定要删除这篇文章吗？');"> <!--让浏览器在删除前弹出确认框，防止误删-->

      <button type="submit" class="btn btn-danger">删除</button>
    </form>
  </div>

</div>
</body>
</html>
